!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core")):"function"==typeof define&&define.amd?define("lazy-for",["exports","@angular/core"],e):e((t=t||self)["lazy-for"]={},t.ng.core)}(this,(function(t,e){"use strict";var i=function(){function t(t,e,i){this.vcr=t,this.tpl=e,this.iterableDiffers=i,this.list=[],this.initialized=!1,this.firstUpdate=!0,this.lastChangeTriggeredByScroll=!1}return Object.defineProperty(t.prototype,"lazyForOf",{set:function(t){this.list=t,t&&(this.differ=this.iterableDiffers.find(t).create(),this.initialized&&this.update())},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.templateElem=this.vcr.element.nativeElement,void 0===this.containerElem&&(this.containerElem=this.templateElem.parentElement),this.containerElem.addEventListener("scroll",(function(e){t.lastChangeTriggeredByScroll=!0})),this.initialized=!0},t.prototype.ngDoCheck=function(){this.differ&&Array.isArray(this.list)&&(this.lastChangeTriggeredByScroll?(this.update(),this.lastChangeTriggeredByScroll=!1):null!==this.differ.diff(this.list)&&this.update())},t.prototype.clamp=function(t,e,i){return i?Math.min(t,e)===t?e:Math.max(t,i)===t?i:t:Math.max(t,e)===e?t:e},t.prototype.onFirstUpdate=function(){var t;void 0!==this.itemHeight&&void 0!==this.itemTagName||(this.vcr.createEmbeddedView(this.tpl,{context:this.list[0],index:0}),t=this.templateElem.nextSibling),void 0===this.itemHeight&&(this.itemHeight=t.clientHeight),void 0===this.itemTagName&&(this.itemTagName=t.tagName),this.beforeListElem=document.createElement(this.itemTagName),this.templateElem.parentElement.insertBefore(this.beforeListElem,this.templateElem),this.afterListElem=document.createElement(this.itemTagName),this.templateElem.parentElement.insertBefore(this.afterListElem,this.templateElem.nextSibling),"li"===this.itemTagName.toLowerCase()&&(this.beforeListElem.style.listStyleType="none",this.afterListElem.style.listStyleType="none"),this.firstUpdate=!1},t.prototype.update=function(){if(0===this.list.length)return this.vcr.clear(),void(this.firstUpdate||(this.beforeListElem.style.height="0",this.afterListElem.style.height="0"));this.firstUpdate&&this.onFirstUpdate();var t=this.containerElem.clientHeight,e=this.containerElem.scrollTop,i=this.beforeListElem.getBoundingClientRect().top-this.beforeListElem.scrollTop-(this.containerElem.getBoundingClientRect().top-this.beforeListElem.scrollTop);this.vcr.clear();var s=Math.floor((e-i)/this.itemHeight);s=this.clamp(s,0,this.list.length);var r=Math.ceil((e-i+t)/this.itemHeight);r=this.clamp(r,-1,this.list.length-1);for(var l=s;l<=r;l++)this.vcr.createEmbeddedView(this.tpl,{context:this.list[l],index:l});this.beforeListElem.style.height=s*this.itemHeight+"px",this.afterListElem.style.height=(this.list.length-r-1)*this.itemHeight+"px"},t.decorators=[{type:e.Directive,args:[{selector:"[lazyFor]"}]}],t.ctorParameters=function(){return[{type:e.ViewContainerRef},{type:e.TemplateRef},{type:e.IterableDiffers}]},t.propDecorators={itemHeight:[{type:e.Input,args:["lazyForWithHeight"]}],containerElem:[{type:e.Input,args:["lazyForWithContainer"]}],itemTagName:[{type:e.Input,args:["lazyForWithTagName"]}],lazyForOf:[{type:e.Input}]},t}();var s=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[i],exports:[i]}]}],t}();t.LazyForDirective=i,t.LazyForModule=s,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=lazy-for.umd.min.js.map